#+TITLE: AmicaDB API
#+AUTHOR: Simon Ericsson
#+EMAIL: simon@krlsg.se

#+DESCRIPTION: Documentation for the AmicaDB API
#+LANGUAGE: en

#+OPTIONS: ^:nil
#+OPTIONS: toc:3

An API used by [[https://simsva.se/amica/][our survey about sleep]]. Source code available at [[https://github.com/Simsva/abb-amicadb-api][GitHub]].

See [[https://github.com/Simsva/abb-amicadb-api/blob/master/nginx_example.conf][nginx_example.conf]] for information on running the API.

* Basic information
** Query arguments
Arguments provided using the query string at the end of the URL.

/Example/: ~.../entries?fields=name,description&order=score~, where ~fields = name,description~ and ~order = score~ are query arguments.

* API Usage
*Base URL*: [[https://api.simsva.se/amicadb/]] (Or another URL pointed to the same PHP script provided in the repository)

API paths are appended at the end of the *Base URL*.

** Paths
*** answer/ (GET)
Get previous answers.

Returns a list of objects.

**** *Query arguments*:
- *fields*

   Comma separated list of which fields to return.

   /Example/: ~.../entries?fields=t,sleep~ only returns the t and sleep fields.

*** answer/ (POST)
Submit an answer.

**** HTTP response codes:
- 200 Successfully submitted.

- 401 Already submitted an answer the current day.

- 404 Invalid token provided.

**** POST arguments:
- *sleep* (/required/)

  How well you have slept from 0 to 10.

- *sleep_time* (/required/)

  How much time you have slept.
  - 0 hours: 0
  - 1-3 hours: 1
  - 4-6 hours: 2
  - 7-9 hours: 3
  - 10+ hours: 4

- *token* (/required/)

  Your token generated by ~token/~.

*** token/ (GET)
Generate a new token.

Returns a 64 character hexadecimal string.
